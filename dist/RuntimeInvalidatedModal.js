import{r,i as x,w as m,s as h,c as g,j as e}from"./index.js";function b(){const[o,i]=r.useState(!1),[l,a]=r.useState(null);r.useEffect(()=>{if(!x()){i(!0),a("Extension context invalidated. Please reload this page.");return}const n=m(()=>{i(!0),a("Extension was reloaded. Please refresh this page to continue.")});return()=>{n()}},[]);const d=r.useCallback(async n=>{try{const t=await h(n,{onRetry:(s,u)=>{console.log(`[Kotodama] Retrying message ${n.type} (attempt ${s})...`,u)}});if(!t.success)throw new Error(t.error||"Request failed");return t.data}catch(t){const s=g(t);throw a(s),(s.includes("reload")||s.includes("refresh"))&&i(!0),t}},[]),c=r.useCallback(()=>{a(null)},[]);return{sendMessage:d,isInvalidated:o,error:l,clearError:c}}const f=({isOpen:o})=>o?e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm z-[100000] flex items-center justify-center p-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-8 max-w-md text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto text-yellow-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-gray-900 dark:text-white",children:"Extension Reloaded"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"The Kotodama extension was updated or reloaded. Please refresh this page to continue."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Reload Page"})]})}):null;export{f as R,b as u};
